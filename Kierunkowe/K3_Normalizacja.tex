\section{K3 - Normalizacja schematu bazy danych}

Normalizacja schematu bazy danych, czyli sprowadzanie schematu do jednej z postaci normalnych jest dokonywana, aby przeciwdziałać lub też zapobiegać problemom, które pojawiają się podczas cyklu życia bazy danych.

Przykładowe problemy związane z użytkowaniem i utrzymaniem bazy danych:
\begin{itemize}
	\item{brak spójności danych,}
	\item{zbyt skomplikowane zapytania,}
	\item{anomalie spowodowane aktualizacją danych.}
\end{itemize}

Normalizacja najczęściej sprowadza się do rozbijania tabel na mniejsze, jednak co ważne, nie wpływa ona na dane, a jedynie na sposób w jaki je przechowujemy.

Sprowadzenie schematu do którejś z postaci normalnych polega na sprawieniu, by schemat spełniał warunki określone przez postać do której dążymy oraz przez wszystkie poprzednie.

Przykładowo: schemat jest w 3NF jeśli spełnia warunki 3NF, 2NF oraz 1NF.

Pan Codd, który był twórcą pojęcia normalizacji, wymyślił trzy postaci normalne, z których trzecia jest przez większość uważana za wystarczającą, jest ich jednak więcej.
\subsection*{1NF}
	Określa podstawowe zasady, które musi spełnić każda dobrze zorganizowana baza danych:
\begin{enumerate}
	\item{Tabele nie posiadają powtarzających się kolumn.}
	\item{Dane w każdej kolumnie są niepodzielne.}
	\item{Każdy wiersz daje się jednoznacznie zidentyfikować.}
	\item{Kolejność wierszy i kolumn nie ma znaczenia.}
	\item{Dane w jednej kolumnie są tego samego rodzaju.}
\end{enumerate}

Czy poniższa tabela spełnia warunki 1NF?

\begin{table}[H]
\centering
\caption{Transakcje - przed normalizacją}
\begin{tabular}{|l|l|l}
\cline{1-2}
Klient         & Towar          & \\ \cline{1-2}
Adam Adamowicz & Lalka barbie   & \\ \cline{1-2}
Anna Annowska  & Lalka barbie, Wino grzane &  \\ \cline{1-2}
\end{tabular}
\end{table}

Widzimy, że tabela nie jest w 1NF, ponieważ kolumna \textit{Klient} zawiera dane, które da się rozbić na dwie mniejsze kolumny -- imię oraz nazwisko klienta.
Brakuje również unikalnego identyfikatora wierszy.
Widzimy też, że w kolumnie \textit{Towar} pojawia się wiele wartości, co jest błędem.

Tabela po sprowadzeniu do 1NF wygląda następująco:
\begin{table}[H]
\centering
\caption{Transakcje - 1NF}
\begin{tabular}{|l|l|l|l|l}
\cline{1-4}
Id & Imię & Nazwisko  & Towar          & \\ \cline{1-4}
1  & Adam & Adamowicz & Lalka barbie   & \\ \cline{1-4}
2  & Anna & Annowska  & Lalka barbie   & \\ \cline{1-4}
3  & Anna & Annowska  & Wino grzane    & \\ \cline{1-4}
\end{tabular}
\end{table}

\subsection*{2NF}
	Druga postać normalna jeszcze bardziej zagłębia się w usuwanie redundancji:
\begin{enumerate}
	\item{Spełnia warunki 1NF.}
	\item{Powiązane i powtarzające się dane zostały przeniesione do osobnej tabeli.}
\end{enumerate}

Po modyfikacjach otrzymujemy:

\begin{table}[H]
\centering
\caption{Klienci - 2NF}
\begin{tabular}{|l|l|l|ll}
\cline{1-3}
Id & Imię & Nazwisko  &  &  \\ \cline{1-3}
1  & Adam & Adamowski &  &  \\ \cline{1-3}
2  & Anna & Annowska  &  &  \\ \cline{1-3}
\end{tabular}
\end{table}

\begin{table}[]
\centering
\caption{Towary - 2NF}
\begin{tabular}{|l|l|ll}
\cline{1-2}
Id & Nazwa        &  &  \\ \cline{1-2}
1  & Lalka barbie &  &  \\ \cline{1-2}
2  & Wino grzane  &  &  \\ \cline{1-2}
\end{tabular}
\end{table}

\begin{table}[]
\centering
\caption{Transakcje - 2NF}
\begin{tabular}{|l|l|l|l}
\cline{1-3}
Id & Id\_klienta & Id\_towaru &  \\ \cline{1-3}
1  & 1           & 1          &  \\ \cline{1-3}
2  & 2           & 1          &  \\ \cline{1-3}
3  & 2           & 2          &  \\ \cline{1-3}
\end{tabular}
\end{table}